---
title: "Final Report"
subtitle: "due November 16, 2021 by 11:59 PM "
author: "Your names and team name here"
date: ""
output: pdf_document
---

# Load Packages

```{r load-packages, message = FALSE, warning = FALSE}
library(tidyverse) 
``` 

# Load Data
```{r load-data, message = FALSE, warning = FALSE}
library(readr)
h_spend <- read_csv("../data/Health-Spending.CSV")
wb_tot_lifeexp <- read_csv("../data/World Bank Life Exp.csv")
wb_f_lifeexp <- read_csv("../data/World Bank Female Life Exp.csv")
wb_m_lifeexp <- read_csv("../data/World Bank Male Life Exp.csv")
econ <- read_csv("../data/EconMetrics.csv")
econ <- select(econ, -4)
```

#Combine Datasets
```{r combine-lifeexp-data}
wb_tot_lifeexp_long <- pivot_longer(wb_tot_lifeexp, cols = "1990":"2020", names_to = "Year", values_to = "Total Life Expectancy")

wb_f_lifeexp_long <- wb_f_lifeexp %>%
  select(c(1:2,34:64)) %>%
  pivot_longer(cols = "1990":"2020", names_to = "Year", values_to = "Female Life Expectancy")

wb_m_lifeexp_long <- wb_m_lifeexp %>%
  select(c(1:2,34:64)) %>%
  pivot_longer(cols = "1990":"2020", names_to = "Year", values_to = "Male Life Expectancy")

lifeexp <- left_join(wb_tot_lifeexp_long, wb_f_lifeexp_long, by = c("Country Name", "Country Code", "Year"))

lifeexp <- left_join(lifeexp, wb_m_lifeexp_long, by = c("Country Name", "Country Code", "Year"))
```

```{r edit_econ_data}
yrs <- c(2011:2020)

colnames(econ) <- c("Country Name", "Country Code", "Series Name", yrs)
econ_temp <- econ %>%
  pivot_longer(cols = 4:13, names_to = "Year", values_to = "Value")
econ_temp2 <- econ_temp %>%
  group_by("Country Name") %>%
  pivot_wider(names_from = "Series Name", values_from = "Value") %>%
  ungroup()
econ2 <- select(econ_temp2, -4)
i <- c(1:230)
j <- c(4:58)
for (x in i) {
  for (y in j) {
    econ2[x, y] <- as.numeric(econ2[x, y], use.name = FALSE)
  }
}
```
```{r edit_h_spend}
h_spend2 <- select(h_spend, -1, -4)
colnames(h_spend2)[1:3] <- c("Country Name", "Country Code", "Year")
```

```{r combine_data}
full_data <- full_join(lifeexp, econ2, by = c("Country Name", "Country Code", "Year"))
full_data$Year = as.double(full_data$Year)
full_data <- full_join(full_data, h_spend2, by = c("Country Name", "Country Code", "Year"))
```

```{r desc_stats_health_spending}
#Below is the distribution of log of Mean total health spending per person (in PPP dollars)
full_data %>%
  filter(Year == 2018) %>%
  filter(is.na(the_per_cap_ppp_mean) == FALSE) %>%
ggplot(aes(x = log(the_per_cap_ppp_mean))) + 
  geom_histogram(fill = "blue") + 
  labs(
    x = "Log of Mean total health spending per person (in PPP dollars)",
    y = "Frequency",
    title = "Distribution of Health Care Spending"
  ) 

#NOTE: TO THE PLOT ABOVE, ADD NORMAL CURVE TO THE ABOVE DISTRIBUTION

#Below are a few quick summary stats for health spending per person
full_data %>%
  select(the_per_cap_ppp_mean) %>%
   filter(is.na(the_per_cap_ppp_mean) == FALSE) %>%
summary(the_per_cap_ppp_mean)

#full_data %>%
 # filter(Year == 2018) %>%
  #filter(is.na(the_per_cap_ppp_mean) == FALSE) %>%
  #  filter(is.na(`GDP (current US$)`) == FALSE) %>%
#ggplot(aes(x = `GDP (current US$)`, y = log(the_per_cap_ppp_mean))) + 
#geom_point(fill = "blue") + 
# labs(
   # x = "Log of Mean total health spending per person (in PPP dollars)",
   # y = "Frequency",
   # title = "Distribution of Health Care Spending"
 # ) 

```